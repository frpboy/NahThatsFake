<p><strong>ğŸ” Nah That's Fake</strong></p><p>Design Document, User Flows &amp; Detection Logic</p><p>Document 2 of 13</p><p>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</p><p><strong>Document: </strong>Document 2 of 13 â€” Design Document, User Flow &amp; Detection Logic</p><p><strong>Version: </strong>v1.0 â€” MVP</p><p><strong>Date: </strong>February 2026</p><p><strong>Status: </strong>Draft â€” For Vibe Coding Reference</p><p><strong>Depends On: </strong>Document 1: PRD + Rules + Bot Logic + Pricing</p><table><tr><td><p><strong>ğŸ“ What This Document Covers</strong></p><p>This document defines HOW Nah That's Fake works â€” the exact screen-by-screen user experience,</p><p>every user flow from onboarding to check to payment, the complete detection decision tree,</p><p>wireframe descriptions for both the bot and the Telegram Mini App (TMA), and the edge</p><p>cases and error states your AI IDE needs to handle correctly.</p></td></tr></table><h1><strong>1. Information Architecture</strong></h1><h2><strong>1.1 System Overview â€” Two Surfaces</strong></h2><p>Nah That's Fake operates across two distinct surfaces that work together. Understanding the boundary between them is critical for building correctly.</p><table><tr><td><p><strong>ğŸ¤– Surface 1: The Telegram Bot</strong></p><p>Exists as @NahThatsFakeBot inside Telegram natively.</p><p>Handles: commands, receiving files/links, returning results as messages.</p><p>Works in: private chats with the bot AND in group chats when tagged.</p><p>Primary use case: quick checks, group viral interactions.</p><p>Has no visual UI â€” output is text + emoji only.</p></td></tr></table><table><tr><td><p><strong>ğŸ“± Surface 2: The Telegram Mini App (TMA)</strong></p><p>A web app (HTML/CSS/JS) that opens inside Telegram via a button.</p><p>Handles: detailed reports, check history, referral management, payments, settings.</p><p>Accessed by: tapping 'Full Report' buttons in bot messages, or via the bot menu button.</p><p>Primary use case: premium features, account management, detailed breakdowns.</p><p>Has full visual UI â€” this is where design matters most.</p></td></tr></table><h2><strong>1.2 Navigation Map â€” Bot Commands</strong></h2><p>Every command the bot responds to is listed here. Full command specification is in Document 8, but designers need this context now.</p><table><thead><tr><th><p><strong>Command</strong></p></th><th><p><strong>What It Does</strong></p></th><th><p><strong>Available To</strong></p></th></tr></thead><tbody><tr><td><p>/start</p></td><td><p>Welcome message + onboarding flow</p></td><td><p>All users</p></td></tr><tr><td><p>/check</p></td><td><p>Prompt user to send image or link</p></td><td><p>All users</p></td></tr><tr><td><p>/credits</p></td><td><p>Show current credit balance + daily remaining</p></td><td><p>All users</p></td></tr><tr><td><p>/refer</p></td><td><p>Generate personal referral link</p></td><td><p>All users</p></td></tr><tr><td><p>/history</p></td><td><p>Last 5 checks summary (opens TMA for full history)</p></td><td><p>All users</p></td></tr><tr><td><p>/premium</p></td><td><p>Show premium plans + payment options</p></td><td><p>All users</p></td></tr><tr><td><p>/help</p></td><td><p>Quick command reference</p></td><td><p>All users</p></td></tr><tr><td><p>/settings</p></td><td><p>Open TMA settings panel</p></td><td><p>All users</p></td></tr><tr><td><p>/groupsetup</p></td><td><p>Configure bot for this group (admin only)</p></td><td><p>Group admins</p></td></tr><tr><td><p>/autoscan</p></td><td><p>Toggle auto-scan mode on/off</p></td><td><p>Premium group admins</p></td></tr></tbody></table><h2><strong>1.3 Navigation Map â€” TMA Screens</strong></h2><p>The TMA has five main sections accessible from a bottom navigation bar.</p><table><thead><tr><th><p><strong>Screen</strong></p></th><th><p><strong>Purpose</strong></p></th><th><p><strong>Access</strong></p></th></tr></thead><tbody><tr><td><p>Home / Dashboard</p></td><td><p>Credit balance, quick check button, recent activity</p></td><td><p>All users</p></td></tr><tr><td><p>Check Detail</p></td><td><p>Full report for a specific check with all signals</p></td><td><p>All users (own checks)</p></td></tr><tr><td><p>History</p></td><td><p>Paginated list of all past checks</p></td><td><p>All users (own history)</p></td></tr><tr><td><p>Referrals</p></td><td><p>Referral link, stats, credited friends list</p></td><td><p>All users</p></td></tr><tr><td><p>Premium</p></td><td><p>Plan comparison, payment, subscription management</p></td><td><p>All users</p></td></tr><tr><td><p>Settings</p></td><td><p>Notifications, account, linked groups</p></td><td><p>All users</p></td></tr><tr><td><p>Group Dashboard</p></td><td><p>Auto-scan controls, group stats, threshold settings</p></td><td><p>Premium group admins</p></td></tr></tbody></table><h1><strong>2. User Flows â€” Step by Step</strong></h1><h2><strong>2.1 Flow A: New User Onboarding (Organic)</strong></h2><p>User discovers the bot organically â€” either by seeing it used in a group or by searching Telegram.</p><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User opens @NahThatsFakeBot or clicks t.me/NahThatsFakeBot</strong></p><p>Telegram opens bot chat window</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>Bot sends Welcome Message automatically (no /start needed)</strong></p><p>See Welcome Message spec below</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>User sees 3 buttons: [Try a Free Check] [How It Works] [View Plans]</strong></p><p>Bot shows inline keyboard</p></td></tr></table><table><tr><td><p><strong>4</strong></p></td><td><p><strong>User taps [Try a Free Check] â€” bot asks: 'Send me an image or paste a link.'</strong></p><p>Bot enters listening state</p></td></tr></table><table><tr><td><p><strong>5</strong></p></td><td><p><strong>User sends image or link</strong></p><p>Bot acknowledges: 'ğŸ” Scanning... this takes about 3 seconds.'</p></td></tr></table><table><tr><td><p><strong>6</strong></p></td><td><p><strong>Bot returns result with Trust Score</strong></p><p>Full result message per Doc 1 templates</p></td></tr></table><table><tr><td><p><strong>7</strong></p></td><td><p><strong>Result includes: [See Full Report] button â€” opens TMA</strong></p><p>TMA opens to Check Detail screen</p></td></tr></table><table><tr><td><p><strong>8</strong></p></td><td><p><strong>TMA shows full breakdown + prompts to create account to save history</strong></p><p>Supabase Auth handles signup</p></td></tr></table><table><tr><td><p><strong>ğŸ’¬ Welcome Message â€” Exact Copy</strong></p><p>ğŸ” Hey! I'm Nah That's Fake â€” your personal scam and deepfake detector.</p><p>In a world full of fake news and AI-generated images, I've got your back.</p><p>Here's what I can do:</p><p>  ğŸ–¼  Detect AI-generated or deepfake images</p><p>  ğŸ”—  Check links for phishing and scams</p><p>You get 3 free checks every day. No signup required to start.</p><p>Send me anything suspicious and I'll tell you what's up. ğŸ‘‡</p></td></tr></table><h2><strong>2.2 Flow B: New User Onboarding (Via Referral Link)</strong></h2><p>User receives a referral link from a friend. This flow is slightly different â€” the +2 credit bonus must be surfaced clearly.</p><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User clicks referral link: t.me/NahThatsFakeBot?start=ref_ABC123</strong></p><p>Referral code captured by bot</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>Bot sends modified Welcome Message that acknowledges the referral</strong></p><p>See Referral Welcome spec below</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>User sees their +2 bonus credits prominently displayed</strong></p><p>Credit counter shows: 3 daily + 2 bonus = 5 available</p></td></tr></table><table><tr><td><p><strong>4</strong></p></td><td><p><strong>Bot says: 'Your friend hooked you up! You start with 2 bonus credits â€” they never expire.'</strong></p><p>Reinforces the value of the referral</p></td></tr></table><table><tr><td><p><strong>5</strong></p></td><td><p><strong>User proceeds with first check</strong></p><p>Same as Flow A from Step 4 onwards</p></td></tr></table><table><tr><td><p><strong>6</strong></p></td><td><p><strong>On first check completion: referrer is notified via bot message</strong></p><p>'ğŸ‰ Your referral scored! +1 credit added.' sent to referrer</p></td></tr></table><h2><strong>2.3 Flow C: Image Check (Primary Use Case)</strong></h2><p>Registered or unregistered user sends an image to check. This is the core product loop.</p><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User sends image directly to bot chat OR forwards an image from another chat</strong></p><p>Telegram delivers as photo or document</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>Bot checks user's remaining checks: daily free + permanent credits</strong></p><p>If 0 remaining â†’ go to Paywall Flow (2.6)</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>Bot deducts 1 check and replies: 'ğŸ” On it... scanning your image now.'</strong></p><p>Shows typing indicator for realism</p></td></tr></table><table><tr><td><p><strong>4</strong></p></td><td><p><strong>Bot downloads image temporarily to memory</strong></p><p>Never written to disk or permanent storage</p></td></tr></table><table><tr><td><p><strong>5</strong></p></td><td><p><strong>SHA-256 hash generated â€” checked against Supabase cache</strong></p><p>Cache HIT â†’ return cached result, skip API call</p></td></tr></table><table><tr><td><p><strong>6</strong></p></td><td><p><strong>Cache MISS â†’ send to Sightengine /check API</strong></p><p>models=genai,type â€” returns 0.0 to 1.0 score</p></td></tr></table><table><tr><td><p><strong>7</strong></p></td><td><p><strong>Score mapped to Risk Level + response template selected</strong></p><p>HIGH &gt;0.80 / MEDIUM 0.40-0.80 / LOW &lt;0.40</p></td></tr></table><table><tr><td><p><strong>8</strong></p></td><td><p><strong>Image deleted from memory. Hash + score + user_id saved to Supabase</strong></p><p>Privacy-first: no images stored</p></td></tr></table><table><tr><td><p><strong>9</strong></p></td><td><p><strong>Bot sends formatted response with Trust Score + verdict</strong></p><p>Includes [Full Report] button â†’ TMA</p></td></tr></table><table><tr><td><p><strong>10</strong></p></td><td><p><strong>In groups: response includes self-promo line at bottom</strong></p><p>Only in group context, not in private chat</p></td></tr></table><h2><strong>2.4 Flow D: Link Check</strong></h2><p>User pastes a URL. The bot extracts, normalises, and checks it against multiple databases simultaneously.</p><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User sends a message containing a URL (raw or embedded in text)</strong></p><p>Bot uses regex to extract URL from message</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>URL normalised: tracking params stripped, shortlinks expanded (bit.ly, t.co etc.)</strong></p><p>Uses requests library to follow redirects</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>Check user's remaining credits â€” deduct 1 if available</strong></p><p>If 0 â†’ Paywall Flow</p></td></tr></table><table><tr><td><p><strong>4</strong></p></td><td><p><strong>Hash of normalised URL checked against Supabase cache</strong></p><p>Cache HIT â†’ return instantly</p></td></tr></table><table><tr><td><p><strong>5</strong></p></td><td><p><strong>Cache MISS â†’ simultaneously call Google Safe Browsing + VirusTotal APIs</strong></p><p>Parallel calls â€” faster than sequential</p></td></tr></table><table><tr><td><p><strong>6</strong></p></td><td><p><strong>Google Safe Browsing returns: SAFE or threat type (MALWARE, SOCIAL_ENGINEERING, etc.)</strong></p><p>Any flag = at least MEDIUM risk</p></td></tr></table><table><tr><td><p><strong>7</strong></p></td><td><p><strong>VirusTotal returns: count of vendors that flagged URL (out of ~90)</strong></p><p>0=LOW / 1-2=MEDIUM / 3+=HIGH</p></td></tr></table><table><tr><td><p><strong>8</strong></p></td><td><p><strong>Combine signals: take the highest risk level from either API</strong></p><p>Conservative approach â€” if in doubt, escalate</p></td></tr></table><table><tr><td><p><strong>9</strong></p></td><td><p><strong>Store normalised URL hash + combined result in Supabase cache</strong></p><p>TTL: 7 days for links (more volatile than images)</p></td></tr></table><table><tr><td><p><strong>10</strong></p></td><td><p><strong>Return formatted response with combined Trust Score</strong></p><p>Includes [Full Report] button â†’ TMA</p></td></tr></table><h2><strong>2.5 Flow E: Group Tagging (The Viral Loop)</strong></h2><p>This is the most important flow for growth. A user tags the bot in a public group to check a suspicious image or link. The response is visible to all group members.</p><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User in a Telegram group replies to a suspicious message with: @NahThatsFakeBot</strong></p><p>Bot is tagged in the reply chain</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>Bot checks if the original message contains an image or link</strong></p><p>If neither: 'I need an image or link to check. Reply to the content you want me to scan.'</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>Bot checks the group's daily quota (free: 10/day shared pool)</strong></p><p>If quota hit: 'This group has hit its daily limit. Upgrade to Group Premium for unlimited checks.'</p></td></tr></table><table><tr><td><p><strong>4</strong></p></td><td><p><strong>If the check can proceed: bot processes identically to Flow C or D</strong></p><p>Same detection logic â€” no difference</p></td></tr></table><table><tr><td><p><strong>5</strong></p></td><td><p><strong>Bot replies IN THE GROUP THREAD (not via DM)</strong></p><p>Public response â€” visible to all members</p></td></tr></table><table><tr><td><p><strong>6</strong></p></td><td><p><strong>Response ends with self-promo: 'ğŸ” Tag @NahThatsFakeBot anywhere to spot fakes instantly.'</strong></p><p>This line only appears in group context</p></td></tr></table><table><tr><td><p><strong>7</strong></p></td><td><p><strong>Group members who see the response can tap to start @NahThatsFakeBot themselves</strong></p><p>This is the viral acquisition loop</p></td></tr></table><table><tr><td><p><strong>ğŸŒ± Why This Is the Viral Engine</strong></p><p>Every single time the bot replies publicly in a large group, it is advertising itself to potentially</p><p>thousands of people who never knew it existed. The bot's punchy, personality-driven response</p><p>stands out in a group chat and makes people curious enough to try it themselves.</p><p>No ad spend required. The product markets itself every time it is used in public.</p></td></tr></table><h2><strong>2.6 Flow F: Paywall (Free Limit Hit)</strong></h2><p>User has used all 3 daily checks and has no permanent credits remaining.</p><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User sends image/link â€” bot detects 0 remaining checks</strong></p><p>Credit check happens BEFORE API call</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>Bot sends Paywall Message (see spec below)</strong></p><p>Friendly, not aggressive â€” explains options</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>User has 3 choices: Refer a Friend / Buy Premium / Come Back Tomorrow</strong></p><p>Three clear CTAs shown as inline buttons</p></td></tr></table><table><tr><td><p><strong>4a</strong></p></td><td><p><strong>If [Refer a Friend] tapped: bot sends referral link immediately</strong></p><p>Quick path to earn free credits</p></td></tr></table><table><tr><td><p><strong>4b</strong></p></td><td><p><strong>If [Get Premium] tapped: TMA opens to Premium screen</strong></p><p>Full plan comparison + payment flow</p></td></tr></table><table><tr><td><p><strong>4c</strong></p></td><td><p><strong>If no action: bot waits. Daily reset happens at midnight IST.</strong></p><p>No further messages unless user interacts</p></td></tr></table><table><tr><td><p><strong>ğŸ’° Paywall Message â€” Exact Copy</strong></p><p>â³ You've used your 3 free checks for today.</p><p>Don't worry â€” here are your options:</p><p>ğŸ¤ Refer a friend â†’ Get +1 permanent credit per referral (never expires)</p><p>â­ Go Premium â†’ Unlimited checks from â‚¹99/month</p><p>â° Wait it out â†’ Resets at midnight IST</p><p>Permanent credits are used before your daily limit, so referrals really add up!</p></td></tr></table><h2><strong>2.7 Flow G: Premium Upgrade (Razorpay)</strong></h2><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User taps [Get Premium] â€” TMA opens to Premium screen</strong></p><p>Shows plan comparison table</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>User selects plan: Monthly (â‚¹99) or Annual (â‚¹799)</strong></p><p>Annual shows '33% off' badge prominently</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>User taps [Pay with UPI / Card]</strong></p><p>Razorpay checkout opens within TMA WebView</p></td></tr></table><table><tr><td><p><strong>4</strong></p></td><td><p><strong>User completes payment via UPI / card / netbanking</strong></p><p>Razorpay handles all payment UI</p></td></tr></table><table><tr><td><p><strong>5</strong></p></td><td><p><strong>Razorpay sends webhook to our backend: payment.captured event</strong></p><p>Backend verifies signature â€” never trust frontend</p></td></tr></table><table><tr><td><p><strong>6</strong></p></td><td><p><strong>Backend updates user's tier in Supabase: free â†’ premium</strong></p><p>Immediate â€” no delay</p></td></tr></table><table><tr><td><p><strong>7</strong></p></td><td><p><strong>TMA shows success screen + confetti animation</strong></p><p>Confirms: 'You're Premium! Unlimited checks, no limits.'</p></td></tr></table><table><tr><td><p><strong>8</strong></p></td><td><p><strong>Bot sends confirmation message in chat</strong></p><p>'ğŸ‰ Premium activated! You now have unlimited checks.'</p></td></tr></table><h2><strong>2.8 Flow H: Premium Upgrade (Telegram Stars)</strong></h2><p>Alternative payment flow for international users who prefer to pay with Telegram Stars.</p><table><tr><td><p><strong>1</strong></p></td><td><p><strong>User taps [Pay with Telegram Stars]</strong></p><p>Bot initiates Stars invoice via Telegram Payments API</p></td></tr></table><table><tr><td><p><strong>2</strong></p></td><td><p><strong>Telegram shows native Stars payment dialog</strong></p><p>User confirms Stars deduction from their balance</p></td></tr></table><table><tr><td><p><strong>3</strong></p></td><td><p><strong>Telegram sends successful_payment update to our bot</strong></p><p>Backend receives and verifies</p></td></tr></table><table><tr><td><p><strong>4</strong></p></td><td><p><strong>Backend upgrades user tier in Supabase</strong></p><p>Same as Razorpay flow from Step 6</p></td></tr></table><h1><strong>3. Detection Logic â€” Deep Dive</strong></h1><h2><strong>3.1 The Complete Decision Tree</strong></h2><p>This is the exact logic your code must implement. Every condition and outcome is defined here.</p><p><strong>Image Detection Decision Tree</strong></p><table><tr><td colspan="3"><p><strong>IMAGE DETECTION OUTCOMES</strong></p></td></tr><tr><td><p><strong>Condition</strong></p></td><td><p><strong>Result</strong></p></td><td><p><strong>Bot Response</strong></p></td></tr><tr><td><p>Sightengine score &gt; 0.80</p></td><td><p>HIGH RISK</p></td><td><p>ğŸš¨ Smells very fake. [X]% AI-generated.</p></td></tr><tr><td><p>Sightengine score 0.40â€“0.80</p></td><td><p>MEDIUM RISK</p></td><td><p>âš ï¸ Something's off here. [X]% suspicious.</p></td></tr><tr><td><p>Sightengine score &lt; 0.40</p></td><td><p>LOW RISK</p></td><td><p>âœ… Looks clean to us. [X]% likely real.</p></td></tr><tr><td><p>No EXIF metadata found (image only)</p></td><td><p>Escalate +1 level</p></td><td><p>Add to breakdown: 'No camera data found'</p></td></tr><tr><td><p>Sightengine API timeout (&gt;8 sec)</p></td><td><p>ERROR â€” retry once</p></td><td><p>If retry fails: 'Our scanner is slow right now, try again in 30s.'</p></td></tr><tr><td><p>Sightengine API rate limit hit</p></td><td><p>QUEUE</p></td><td><p>Add to queue. Notify: 'Queued â€” result in ~2 minutes.'</p></td></tr><tr><td><p>Image &gt; 20MB</p></td><td><p>REJECT</p></td><td><p>'This image is too large. Max size is 20MB.'</p></td></tr><tr><td><p>Non-image file type</p></td><td><p>REJECT</p></td><td><p>'Please send an image file (JPG, PNG, WebP, GIF).'</p></td></tr><tr><td><p>Cache HIT (same hash seen before)</p></td><td><p>CACHED RESULT</p></td><td><p>Return cached score. Note: '(Cached result from [date])'</p></td></tr></table><p><strong>Link Detection Decision Tree</strong></p><table><tr><td colspan="3"><p><strong>LINK DETECTION OUTCOMES</strong></p></td></tr><tr><td><p><strong>Condition</strong></p></td><td><p><strong>Result</strong></p></td><td><p><strong>Bot Response</strong></p></td></tr><tr><td><p>VirusTotal: 3+ vendors flagged</p></td><td><p>HIGH RISK</p></td><td><p>ğŸš¨ Scam alert. [N] security systems flagged this link.</p></td></tr><tr><td><p>VirusTotal: 1-2 vendors flagged</p></td><td><p>MEDIUM RISK</p></td><td><p>âš ï¸ Looks sketchy. [N] system(s) flagged this link.</p></td></tr><tr><td><p>VirusTotal: 0 flags + Google SAFE</p></td><td><p>LOW RISK</p></td><td><p>âœ… Looks clean. No flags from our databases.</p></td></tr><tr><td><p>Google Safe Browsing: SOCIAL_ENGINEERING</p></td><td><p>HIGH RISK (override)</p></td><td><p>ğŸš¨ Confirmed phishing attempt. Do not click.</p></td></tr><tr><td><p>Google Safe Browsing: MALWARE</p></td><td><p>HIGH RISK (override)</p></td><td><p>ğŸš¨ Malware detected. Do not visit this site.</p></td></tr><tr><td><p>Google Safe Browsing: UNWANTED_SOFTWARE</p></td><td><p>MEDIUM RISK</p></td><td><p>âš ï¸ This site may install unwanted software.</p></td></tr><tr><td><p>URL cannot be resolved (404/DNS fail)</p></td><td><p>WARN</p></td><td><p>'This link doesn't seem to work â€” it may already be taken down.'</p></td></tr><tr><td><p>URL is a known shortlink (bit.ly etc.)</p></td><td><p>AUTO-EXPAND</p></td><td><p>Expand first, then check expanded URL. Show both in report.</p></td></tr><tr><td><p>URL contains suspicious TLD (.xyz, .tk, .ml)</p></td><td><p>Escalate +1 level</p></td><td><p>Note in breakdown: 'Unusual domain extension detected'</p></td></tr><tr><td><p>VirusTotal API limit hit</p></td><td><p>DEGRADE GRACEFULLY</p></td><td><p>Use Google Safe Browsing only. Note in report.</p></td></tr><tr><td><p>Both APIs fail</p></td><td><p>ERROR</p></td><td><p>'Our link scanner is having issues. Try again in a few minutes.'</p></td></tr></table><h2><strong>3.2 Confidence Score Calculation</strong></h2><p>The final Trust Score shown to the user is not always a direct API output. Here is how it is calculated:</p><table><tr><td><p><strong>ğŸ“ Image Score Formula</strong></p><p>Final Score = Sightengine genai_score</p><p>Modifiers (applied additionally to the displayed breakdown, not to the score):</p><p>  â€¢ No EXIF data â†’ display warning note, escalate risk level by 1 tier</p><p>  â€¢ Inconsistent metadata â†’ display warning note</p><p>  â€¢ Known stock image hash â†’ display note: 'This is a stock image â€” not AI-generated but may be misused'</p><p>Example: Sightengine returns 0.72 (MEDIUM). No EXIF data found. â†’ Score displayed as 72%, risk shown as HIGH.</p></td></tr></table><table><tr><td><p><strong>ğŸ“ Link Score Formula</strong></p><p>Final Score = weighted combination:</p><p>  If Google Safe Browsing = flagged: Score = 90%+ (always HIGH)</p><p>  If VirusTotal flags = 0: Score = 5% (LOW)</p><p>  If VirusTotal flags = 1: Score = 45% (MEDIUM)</p><p>  If VirusTotal flags = 2: Score = 65% (MEDIUM)</p><p>  If VirusTotal flags = 3+: Score = 85%+ (HIGH, scaled by flag count)</p><p>Suspicious TLD modifier: +10% added to score if domain uses .xyz, .tk, .ml, .cf, .gq, .ga</p></td></tr></table><h2><strong>3.3 EXIF Analysis (Image Only)</strong></h2><p>When an image is received, we extract and analyse its EXIF metadata. This is a free signal that costs no API calls.</p><table><thead><tr><th><p><strong>EXIF Signal</strong></p></th><th><p><strong>What It Means</strong></p></th><th><p><strong>Risk Impact</strong></p></th></tr></thead><tbody><tr><td><p>No EXIF data at all</p></td><td><p>Camera apps always embed EXIF. Absence is suspicious.</p></td><td><p>Escalate risk level by 1 tier</p></td></tr><tr><td><p>EXIF present, camera make/model exists</p></td><td><p>Likely taken by a real camera</p></td><td><p>No change</p></td></tr><tr><td><p>EXIF present, software = 'Adobe Photoshop'</p></td><td><p>Edited but not necessarily AI</p></td><td><p>Note in breakdown only</p></td></tr><tr><td><p>EXIF present, software = AI generator name</p></td><td><p>Confirmed AI tool used</p></td><td><p>Force HIGH RISK regardless of score</p></td></tr><tr><td><p>GPS coordinates present</p></td><td><p>Real photo with location data â€” genuine signal</p></td><td><p>Reduce risk display slightly</p></td></tr><tr><td><p>Timestamp in future</p></td><td><p>Metadata manipulation detected</p></td><td><p>Escalate risk level by 1 tier</p></td></tr></tbody></table><h1><strong>4. TMA Screen Specifications (Wireframes)</strong></h1><p>These are text-based wireframe descriptions for each TMA screen. Your designer or AI IDE should use these as the source of truth for what appears on each screen and in what order.</p><h2><strong>4.1 Screen: Home / Dashboard</strong></h2><table><tr><td><p><strong>ğŸ“± Nah That's Fake â€” Home</strong></p></td></tr><tr><td><p><strong>ğŸ” Nah That's Fake</strong></p></td></tr><tr><td><p><strong>Credit Balance</strong></p></td></tr><tr><td><p>3 daily + 2 bonus = 5 checks available</p></td></tr><tr><td><p><strong>[ ğŸ”  Check Something Now  ]</strong></p></td></tr><tr><td><p><strong>Recent Checks</strong></p></td></tr><tr><td><p>ğŸ–¼  Image check â€” HIGH RISK (87%)  â†’  2 mins ago</p></td></tr><tr><td><p>ğŸ”—  Link check â€” LOW RISK (5%)  â†’  1 hour ago</p></td></tr><tr><td><p>ğŸ–¼  Image check â€” MEDIUM RISK (61%)  â†’  yesterday</p></td></tr><tr><td><p>[ History ]  [ Referrals ]  [ Premium ]  [ Settings ]</p></td></tr></table><ul><li>Credit balance is the most prominent element â€” always above the fold.</li><li>The primary CTA button [Check Something Now] triggers the bot to ask for input.</li><li>Recent checks are tappable rows that open the Check Detail screen.</li><li>Bottom nav is fixed and always visible.</li></ul><h2><strong>4.2 Screen: Check Detail</strong></h2><table><tr><td><p><strong>ğŸ“± Check Detail â€” HIGH RISK Example</strong></p></td></tr><tr><td><p>â† Back to History</p></td></tr><tr><td><p><strong>ğŸš¨ HIGH RISK</strong></p></td></tr><tr><td><p>87% likely AI-generated</p></td></tr><tr><td><p>Image checked: 14 Feb 2026, 3:42 PM</p></td></tr><tr><td><p><strong>Detection Breakdown</strong></p></td></tr><tr><td><p>Sightengine genai score: 89%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘</p></td></tr><tr><td><p>EXIF analysis: No camera metadata found âš ï¸</p></td></tr><tr><td><p>Risk escalated: Missing EXIF bumped risk to HIGH</p></td></tr><tr><td><p><strong>What This Means</strong></p></td></tr><tr><td><p>AI image generators don't embed camera data. Combined with a high AI score, this image is very likely synthetic.</p></td></tr><tr><td><p>[ ğŸ“„ Export PDF Report ]  (Premium only)</p></td></tr><tr><td><p>âš ï¸ This is probabilistic analysis, not a legal determination.</p></td></tr></table><h2><strong>4.3 Screen: Referrals</strong></h2><table><tr><td><p><strong>ğŸ“± Referrals</strong></p></td></tr><tr><td><p><strong>ğŸ¤ Refer &amp; Earn</strong></p></td></tr><tr><td><p>You earn +1 credit. They get +2 credits. Everyone wins.</p></td></tr><tr><td><p><strong>Your referral link:</strong></p></td></tr><tr><td><p>t.me/NahThatsFakeBot?start=ref_ABC123</p></td></tr><tr><td><p><strong>[ ğŸ“‹ Copy Link ]    [ ğŸ“¤ Share ]</strong></p></td></tr><tr><td><p><strong>Your Referral Stats</strong></p></td></tr><tr><td><p>Total referrals: 4    Credits earned: 4    Pending: 1</p></td></tr><tr><td><p><strong>Friends You've Referred:</strong></p></td></tr><tr><td><p>âœ… @friend1 â€” credited   âœ… @friend2 â€” credited</p></td></tr><tr><td><p>âœ… @friend3 â€” credited   â³ @friend4 â€” pending first check</p></td></tr></table><h2><strong>4.4 Screen: Premium Plans</strong></h2><table><tr><td><p><strong>ğŸ“± Premium Plans</strong></p></td></tr><tr><td><p><strong>â­ Go Premium</strong></p></td></tr><tr><td><p><strong>FREE  |  â‚¹0/mo</strong></p></td></tr><tr><td><p>3 checks/day â€¢ Referral credits â€¢ Basic report</p></td></tr><tr><td><p><strong>INDIVIDUAL  |  â‚¹99/mo or â‚¹799/yr  â† BEST VALUE</strong></p></td></tr><tr><td><p>Unlimited checks â€¢ PDF export â€¢ Full reports â€¢ History</p></td></tr><tr><td><p><strong>GROUP ADMIN  |  â‚¹299/mo</strong></p></td></tr><tr><td><p>All Individual features + Auto-scan mode + Group dashboard</p></td></tr><tr><td><p><strong>[ Pay with UPI / Card (Razorpay) ]</strong></p></td></tr><tr><td><p><strong>[ Pay with Telegram Stars â­ ]</strong></p></td></tr></table><h1><strong>5. Edge Cases &amp; Error States</strong></h1><p>Your AI IDE must handle all of these cases. Unhandled edge cases will cause the bot to silently fail or behave unexpectedly.</p><h2><strong>5.1 Bot Edge Cases</strong></h2><table><thead><tr><th><p><strong>Scenario</strong></p></th><th><p><strong>Expected Behaviour</strong></p></th></tr></thead><tbody><tr><td><p>User sends video file</p></td><td><p>'I can check images and links, but not video yet. That's coming soon! ğŸ¬'</p></td></tr><tr><td><p>User sends audio file</p></td><td><p>'Audio detection is coming in Phase 2. Stay tuned! ğŸµ'</p></td></tr><tr><td><p>User sends a PDF</p></td><td><p>'I can't check PDFs yet. Try extracting the link or image from it first.'</p></td></tr><tr><td><p>User sends a Telegram sticker</p></td><td><p>'Stickers are Telegram's own content â€” safe to ignore!'</p></td></tr><tr><td><p>User sends an emoji or plain text</p></td><td><p>'Send me an image or a link and I'll check it for you.'</p></td></tr><tr><td><p>User sends multiple images at once</p></td><td><p>Check the first one only. Reply: 'I checked the first image. Send them one at a time for best results!'</p></td></tr><tr><td><p>Bot is added to a group but not tagged</p></td><td><p>Bot stays silent. It ONLY speaks when tagged or in auto-scan mode.</p></td></tr><tr><td><p>User sends /check without following up</p></td><td><p>Bot waits 60 seconds, then: 'Still waiting! Send me an image or link to check.'</p></td></tr><tr><td><p>User sends broken/malformed URL</p></td><td><p>'That URL doesn't seem valid. Check it and try again?'</p></td></tr><tr><td><p>Telegram file download fails</p></td><td><p>'Couldn't download your image â€” Telegram may be having issues. Try again in a moment.'</p></td></tr></tbody></table><h2><strong>5.2 API Error Handling</strong></h2><table><thead><tr><th><p><strong>API</strong></p></th><th><p><strong>Error Type</strong></p></th><th><p><strong>User-Facing Response</strong></p></th></tr></thead><tbody><tr><td><p>Sightengine</p></td><td><p>Timeout &gt; 8s</p></td><td><p>'Scanner is slow right now. Retrying... (retry once, then queue)'</p></td></tr><tr><td><p>Sightengine</p></td><td><p>Rate limit (429)</p></td><td><p>'Too many checks at once â€” your result is queued. ~2 min wait.'</p></td></tr><tr><td><p>Sightengine</p></td><td><p>Invalid API key</p></td><td><p>SILENT FAIL â€” log error, alert admin via separate channel. Show: 'Scanner unavailable, try later.'</p></td></tr><tr><td><p>VirusTotal</p></td><td><p>Rate limit (4/min)</p></td><td><p>Skip VirusTotal this request. Use Google Safe Browsing only. Note in report.</p></td></tr><tr><td><p>VirusTotal</p></td><td><p>API down</p></td><td><p>Skip VirusTotal. Note in report: 'One of our databases was unavailable.'</p></td></tr><tr><td><p>Google Safe Browsing</p></td><td><p>API down</p></td><td><p>Skip GSB. Use VirusTotal only. Note in report.</p></td></tr><tr><td><p>Both link APIs down</p></td><td><p>Return error</p></td><td><p>'Our link scanner is having a moment. Try again in a few minutes. ğŸ”§'</p></td></tr><tr><td><p>Supabase down</p></td><td><p>Cache miss forced</p></td><td><p>Log error. Proceed with API calls. Results won't be cached.</p></td></tr><tr><td><p>Razorpay webhook fails</p></td><td><p>Retry 3 times</p></td><td><p>If all fail: flag for manual review. Do NOT activate premium until confirmed.</p></td></tr></tbody></table><h2><strong>5.3 Rate Limiting &amp; Abuse</strong></h2><table><tr><td><p><strong>ğŸ›¡ Abuse Prevention Rules (Must Implement)</strong></p><p>1. Any account with &gt;50 checks in 60 minutes â†’ flag for review + throttle to 1 check/10 minutes.</p><p>2. Any account attempting &gt;5 failed referral redemptions in a day â†’ flag + block referral for 24h.</p><p>3. Newly created Telegram accounts (&lt;24h old) cannot refer others â€” credits held pending 24h account age.</p><p>4. Group auto-scan: maximum 100 auto-scan alerts per group per day (even on premium) to prevent spam.</p><p>5. Single IP sending checks for &gt;10 different Telegram accounts â†’ flag for review.</p></td></tr></table><h1><strong>6. Bot Conversation State Management</strong></h1><p>The bot must track what state each user is in to respond correctly. This is managed via a simple state machine stored in Supabase (or in-memory for speed).</p><h2><strong>6.1 User States</strong></h2><table><thead><tr><th><p><strong>State</strong></p></th><th><p><strong>Description</strong></p></th><th><p><strong>Transitions To</strong></p></th></tr></thead><tbody><tr><td><p>IDLE</p></td><td><p>Bot is not waiting for any input from this user</p></td><td><p>WAITING_FOR_MEDIA on /check or direct send</p></td></tr><tr><td><p>WAITING_FOR_MEDIA</p></td><td><p>User tapped [Try a Check] or /check â€” bot is listening</p></td><td><p>PROCESSING on media/link received</p></td></tr><tr><td><p>PROCESSING</p></td><td><p>API call in flight â€” bot is checking content</p></td><td><p>IDLE on result sent</p></td></tr><tr><td><p>QUEUED</p></td><td><p>API rate limit hit â€” user is in the wait queue</p></td><td><p>PROCESSING when queue slot opens</p></td></tr><tr><td><p>PAYWALL</p></td><td><p>User hit credit limit â€” shown upgrade options</p></td><td><p>IDLE if they dismiss / PROCESSING if they upgrade</p></td></tr><tr><td><p>ONBOARDING</p></td><td><p>Brand new user in welcome flow</p></td><td><p>IDLE after welcome completed</p></td></tr></tbody></table><h2><strong>6.2 Group States</strong></h2><table><thead><tr><th><p><strong>Group State</strong></p></th><th><p><strong>Description</strong></p></th></tr></thead><tbody><tr><td><p>NOT_CONFIGURED</p></td><td><p>Bot added to group but admin hasn't set it up</p></td></tr><tr><td><p>FREE</p></td><td><p>Group on free tier â€” 10 checks/day shared pool</p></td></tr><tr><td><p>PREMIUM_ACTIVE</p></td><td><p>Group on paid premium â€” unlimited checks</p></td></tr><tr><td><p>PREMIUM_LAPSED</p></td><td><p>Payment failed â€” grace period (3 days) then back to FREE</p></td></tr><tr><td><p>AUTOSCAN_ON</p></td><td><p>Premium group with auto-scan monitoring enabled</p></td></tr><tr><td><p>AUTOSCAN_OFF</p></td><td><p>Premium group with auto-scan disabled (manual tag only)</p></td></tr></tbody></table><table><tr><td><p><strong>ğŸ“Œ Document Status</strong></p><p>Document 2 of 13 â€” COMPLETE</p><p>Next: Document 3 â€” Payment + Premium Logic (Razorpay + Telegram Stars integration details,</p><p>webhook handling, subscription lifecycle, failed payment recovery)</p><p>This document is the blueprint your AI IDE uses to build every user interaction. Share it at the</p><p>start of every coding session for this project as context.</p></td></tr></table>