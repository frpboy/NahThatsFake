<p><strong>ğŸ” Nah That's Fake</strong></p><p>Telegram Commands â€” Full Specification</p><p>Document 8 of 13</p><p>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</p><p><strong>Document: </strong>Document 8 of 13 â€” Telegram Commands</p><p><strong>Version: </strong>v1.0 â€” MVP</p><p><strong>Date: </strong>February 2026</p><p><strong>Status: </strong>Draft â€” Primary Reference for Bot Handlers</p><p><strong>Bot Handle: </strong>@NahThatsFakeBot</p><table><tr><td><p><strong>âŒ¨ï¸ What This Document Covers</strong></p><p>The complete specification for every command and non-command interaction in @NahThatsFakeBot.</p><p>For each command: access level, context (private vs group), full handler logic, and the</p><p>exact copy for every possible bot response including all edge cases.</p><p>This is the document your AI IDE should have open when building bot handlers.</p><p>Every string the bot sends to a user originates here.</p></td></tr></table><h1><strong>1. Command Overview</strong></h1><table><thead><tr><th><p><strong>Command</strong></p></th><th><p><strong>Description</strong></p></th><th><p><strong>Access</strong></p></th><th><p><strong>Private?</strong></p></th><th><p><strong>Group?</strong></p></th></tr></thead><tbody><tr><td><p>/start</p></td><td><p>Welcome + onboarding (or referral onboarding)</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âŒ (auto in DM)</p></td></tr><tr><td><p>/check</p></td><td><p>Prompt user to send image or link</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âœ…</p></td></tr><tr><td><p>/credits</p></td><td><p>Show credit balance and daily remaining</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âœ… (ephemeral)</p></td></tr><tr><td><p>/refer</p></td><td><p>Generate and show referral link</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âœ… (ephemeral)</p></td></tr><tr><td><p>/history</p></td><td><p>Show last 5 checks + TMA link for full list</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âœ… (ephemeral)</p></td></tr><tr><td><p>/premium</p></td><td><p>Show plans + upgrade options</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âœ… (ephemeral)</p></td></tr><tr><td><p>/help</p></td><td><p>Quick command reference</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âœ…</p></td></tr><tr><td><p>/legal</p></td><td><p>Links to Terms, Privacy, Disclaimer</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âœ…</p></td></tr><tr><td><p>/settings</p></td><td><p>Open TMA settings panel</p></td><td><p>All users</p></td><td><p>âœ…</p></td><td><p>âŒ</p></td></tr><tr><td><p>/groupsetup</p></td><td><p>Configure bot for the group</p></td><td><p>Group admins only</p></td><td><p>âŒ</p></td><td><p>âœ…</p></td></tr><tr><td><p>/autoscan</p></td><td><p>Toggle auto-scan on/off</p></td><td><p>Premium group admins</p></td><td><p>âŒ</p></td><td><p>âœ…</p></td></tr><tr><td><p>/groupstats</p></td><td><p>Show group usage stats</p></td><td><p>Group admins only</p></td><td><p>âŒ</p></td><td><p>âœ…</p></td></tr></tbody></table><table><tr><td><p><strong>ğŸ“ Terminology Used in This Document</strong></p><p>Private chat:   1-on-1 conversation between user and @NahThatsFakeBot</p><p>Group chat:     Any Telegram group where the bot has been added</p><p>Ephemeral:      Bot replies only to the user who ran the command, not the whole group</p><p>Inline keyboard: Row of buttons shown below a bot message</p><p>TMA:            Telegram Mini App â€” opens in-app browser within Telegram</p><p>Handler:        The Python function that processes a specific command or message type</p></td></tr></table><h1><strong>2. Command Specifications</strong></h1><h2><strong>2.1  /start</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/start  </strong>â€” Welcome message and onboarding</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private chat only</p></td><td><p><strong>Logic</strong></p><p>1. Check if payload contains referral code (e.g. ref_ABC123).</p><p>2. If referral code present â†’ referral onboarding flow.</p><p>3. If no referral code â†’ standard welcome flow.</p><p>4. Check if user has already seen onboarding (consent_given flag).</p><p>5. If consent_given = false â†’ show consent + welcome.</p><p>6. If consent_given = true â†’ show returning user welcome.</p></td></tr><tr><td><p><strong>Standard welcome</strong></p></td><td><p>ğŸ” Hey! I'm Nah That's Fake â€” your deepfake and scam detector.</p><p>Send me anything suspicious and I'll tell you what's up.</p><p>ğŸ–¼  Image â†’ I'll check if it's AI-generated</p><p>ğŸ”—  Link  â†’ I'll check if it's phishing or a scam</p><p>You get 3 free checks daily. Referral credits never expire.</p><p>What do you want to check first? ğŸ‘‡</p></td></tr><tr><td><p><strong>Referral welcome</strong></p></td><td><p>ğŸ‘‹ Hey! Your friend [referrer_name] sent you here.</p><p>Good news: you start with +2 bonus credits â€” they never expire.</p><p>Your friend gets +1 credit when you complete your first check.</p><p>ğŸ–¼  Send me an image to check if it's AI-generated</p><p>ğŸ”—  Or paste a link to check for scams</p><p>You've got 3 daily + 2 bonus = 5 checks ready. Go! ğŸ‘‡</p></td></tr><tr><td><p><strong>Returning user</strong></p></td><td><p>ğŸ‘‹ Welcome back!</p><p>You have [N] checks available today + [N] permanent credits.</p><p>Send me an image or link anytime. ğŸ”</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ” Try a Free Check ]   [ â“ How It Works ]   [ â­ View Plans ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.2  /check</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/check  </strong>â€” Prompt user to send image or link for analysis</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private + Group</p></td><td><p><strong>Logic</strong></p><p>1. Bot enters WAITING_FOR_MEDIA state for this user.</p><p>2. Send prompt message asking for image or link.</p><p>3. Wait up to 60 seconds for media.</p><p>4. If nothing received in 60s â†’ send timeout message, return to IDLE.</p><p>5. In groups: reply is visible to all members.</p></td></tr><tr><td><p><strong>Prompt (private)</strong></p></td><td><p>ğŸ” Ready! Send me:</p><p>  ğŸ–¼  An image to check for AI/deepfake</p><p>  ğŸ”—  A link to check for phishing/scams</p><p>Just send it directly â€” no need for any extra commands.</p></td></tr><tr><td><p><strong>Prompt (group)</strong></p></td><td><p>ğŸ” Sure! Reply to the image or link you want me to check,</p><p>or send it directly to me now.</p></td></tr><tr><td><p><strong>Timeout (60s)</strong></p></td><td><p>â³ Still waiting! Send me an image or a link whenever you're ready.</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ Cancel ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.3  /credits</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/credits  </strong>â€” Show current credit balance and daily usage</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private + Group (ephemeral in group)</p></td><td><p><strong>Logic</strong></p><p>1. Fetch user's daily check count (since midnight IST).</p><p>2. Fetch user's permanent credit balance.</p><p>3. Fetch user's plan (free / premium).</p><p>4. Calculate checks remaining today.</p><p>5. In groups: reply only visible to the user who ran the command.</p></td></tr><tr><td><p><strong>Free user</strong></p></td><td><p>ğŸ’³ Your Credits</p><p>Daily free checks:   [3 - used_today] remaining (resets midnight IST)</p><p>Permanent credits:   [N] (never expire)</p><p>Total available now: [daily_remaining + permanent_credits]</p><p>Earn more: refer a friend â†’ +1 permanent credit per referral.</p></td></tr><tr><td><p><strong>Premium user</strong></p></td><td><p>ğŸ’³ Your Credits â€” Premium</p><p>âœ… Unlimited checks (Premium active until [date])</p><p>Permanent credits: [N] (banked â€” used after premium expires)</p><p>Premium expires in [N] days. Renew to keep unlimited access.</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ¤ Get Referral Link ]   [ â­ View Premium ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.4  /refer</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/refer  </strong>â€” Generate and display personal referral link</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private + Group (ephemeral in group)</p></td><td><p><strong>Logic</strong></p><p>1. Fetch or generate user's unique referral code.</p><p>2. Build referral URL: t.me/NahThatsFakeBot?start=ref_[code]</p><p>3. Fetch user's referral stats: total referrals, credited, pending.</p><p>4. Display stats + link + share button.</p></td></tr><tr><td><p><strong>Referral message</strong></p></td><td><p>ğŸ¤ Your Referral Link</p><p>Share this link. When your friend completes their first check:</p><p>  â€¢ They get: +2 permanent credits</p><p>  â€¢ You get:  +1 permanent credit</p><p>No limit. Refer 100 friends â†’ 100 permanent credits. Forever.</p><p>Your link:</p><p>t.me/NahThatsFakeBot?start=ref_[CODE]</p><p>ğŸ“Š Your stats:</p><p>  Total referrals: [N]  |  Credited: [N]  |  Pending: [N]</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ“‹ Copy Link ]   [ ğŸ“¤ Share Link ]   [ ğŸ“Š View Full Stats â†’ ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.5  /history</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/history  </strong>â€” Show last 5 checks summary with link to full TMA history</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private + Group (ephemeral in group)</p></td><td><p><strong>Logic</strong></p><p>1. Fetch user's last 5 checks from Supabase (ordered by created_at DESC).</p><p>2. Format each as a one-line summary: type + risk + time.</p><p>3. Include button to open TMA History screen for full list.</p><p>4. Free users see last 5 only. Premium users shown 'View all 500+ â†’'.</p></td></tr><tr><td><p><strong>History list</strong></p></td><td><p>ğŸ• Your Recent Checks</p><p>1. ğŸ–¼  Image    â€” ğŸš¨ HIGH (87%)   â€” 5 mins ago</p><p>2. ğŸ”—  Link     â€” âœ… LOW (4%)    â€” 2 hours ago</p><p>3. ğŸ–¼  Image    â€” âš ï¸ MEDIUM (61%) â€” yesterday</p><p>4. ğŸ”—  Link     â€” âœ… LOW (8%)    â€” 2 days ago</p><p>5. ğŸ–¼  Image    â€” ğŸš¨ HIGH (92%)  â€” 3 days ago</p><p>Tap any result in the app to see the full breakdown.</p></td></tr><tr><td><p><strong>No history yet</strong></p></td><td><p>ğŸ“­ No checks yet!</p><p>Send me an image or link and I'll check it for you.</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ“± View Full History â†’ ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.6  /premium</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/premium  </strong>â€” Show premium plans and open payment flow</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private + Group (ephemeral in group)</p></td><td><p><strong>Logic</strong></p><p>1. Check if user is already premium.</p><p>2. If already premium â†’ show current plan status + expiry.</p><p>3. If free user â†’ show plan comparison + payment buttons.</p><p>4. Buttons open TMA Premium screen for payment.</p></td></tr><tr><td><p><strong>Free user â€” plan options</strong></p></td><td><p>â­ Go Premium â€” Nah That's Fake</p><p>FREE           â†’ 3 checks/day, referral credits</p><p>INDIVIDUAL     â†’ Unlimited checks, full reports, PDF export</p><p>               â‚¹99/month  or  â‚¹799/year (save 33%)</p><p>GROUP ADMIN    â†’ All Individual + auto-scan + group dashboard</p><p>               â‚¹299/month per group</p><p>Credits never expire. You keep them even if you go back to free.</p></td></tr><tr><td><p><strong>Already premium</strong></p></td><td><p>âœ… You're on Premium Individual</p><p>Active until: [date] ([N] days remaining)</p><p>Checks used this period: [N]</p><p>Need to manage your plan or renew early?</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ“± View Plans &amp; Pay â†’ ]   [ ğŸ¤ Refer Instead (Free) ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.7  /help</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/help  </strong>â€” Quick command reference</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private + Group</p></td><td><p><strong>Logic</strong></p><p>1. Send a static help message listing all commands.</p><p>2. No database calls needed â€” purely static response.</p><p>3. In groups: reply visible to all (not ephemeral â€” it's helpful info).</p></td></tr><tr><td><p><strong>Help message</strong></p></td><td><p>ğŸ” Nah That's Fake â€” Commands</p><p>/check       â€” Check an image or link</p><p>/credits     â€” View your credit balance</p><p>/refer       â€” Get your referral link (+1 credit per referral)</p><p>/history     â€” View your recent checks</p><p>/premium     â€” View plans and upgrade</p><p>/legal       â€” Terms, Privacy &amp; Disclaimer</p><p>/settings    â€” Open settings (private chat only)</p><p>/help        â€” This message</p><p>In groups: tag @NahThatsFakeBot in a reply to check that content.</p><p>Questions? Contact: [support handle or email]</p></td></tr></table></td></tr></table><h2><strong>2.8  /legal</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/legal  </strong>â€” Links to all legal documents</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private + Group (ephemeral in group)</p></td><td><p><strong>Logic</strong></p><p>1. Send static message with links to all legal docs.</p><p>2. Links open in TMA WebView or external browser.</p><p>3. No database calls needed.</p></td></tr><tr><td><p><strong>Legal links</strong></p></td><td><p>ğŸ“„ Legal Documents â€” Nah That's Fake</p><p>Terms of Service:   [TERMS_URL]</p><p>Privacy Policy:     [PRIVACY_URL]</p><p>Disclaimer:         [DISCLAIMER_URL]</p><p>Refund Policy:      [REFUND_URL]</p><p>By using @NahThatsFakeBot you agree to our Terms of Service.</p><p>We store anonymised data only. No images are ever saved.</p></td></tr></table></td></tr></table><h2><strong>2.9  /settings</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/settings  </strong>â€” Open TMA settings panel</p></td></tr><tr><td><p><strong>Access</strong></p><p>All users</p><p><strong>Context</strong></p><p>Private chat only</p></td><td><p><strong>Logic</strong></p><p>1. Only works in private chat â€” ignore if sent in group.</p><p>2. Send message with button that opens TMA Settings screen.</p><p>3. TMA handles all settings UI.</p></td></tr><tr><td><p><strong>Settings prompt</strong></p></td><td><p>âš™ï¸ Settings</p><p>Manage your account, notifications, and linked groups</p><p>in the Nah That's Fake app.</p></td></tr><tr><td><p><strong>If sent in group</strong></p></td><td><p>âš™ï¸ Settings are only available in private chat.</p><p>Start a conversation with @NahThatsFakeBot to open settings.</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ âš™ï¸ Open Settings â†’ ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.10  /groupsetup</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/groupsetup  </strong>â€” Configure bot for the current group (admin only)</p></td></tr><tr><td><p><strong>Access</strong></p><p>Group admins only</p><p><strong>Context</strong></p><p>Group chat only</p></td><td><p><strong>Logic</strong></p><p>1. Verify sender is a group admin via getChatMember API call.</p><p>2. If not admin â†’ reply with permission error.</p><p>3. If admin â†’ show current group config + setup options.</p><p>4. Save group_id to groups table in Supabase if not already present.</p><p>5. Show group's current plan (free/premium) and daily usage.</p></td></tr><tr><td><p><strong>Admin â€” free group</strong></p></td><td><p>âš™ï¸ Group Setup â€” [Group Name]</p><p>Current plan: FREE (10 checks/day shared pool)</p><p>Checks used today: [N] / 10</p><p>To unlock unlimited checks + auto-scan mode:</p><p>â†’ Upgrade to Group Premium (â‚¹299/month)</p><p>Group ID: [group_id] (save this for support queries)</p></td></tr><tr><td><p><strong>Admin â€” premium group</strong></p></td><td><p>âš™ï¸ Group Setup â€” [Group Name]</p><p>Current plan: âœ… GROUP PREMIUM</p><p>Active until: [date]</p><p>Auto-scan: [ON / OFF]</p><p>Auto-scan threshold: [N]% confidence</p><p>All [N] members have unlimited checks.</p></td></tr><tr><td><p><strong>Non-admin</strong></p></td><td><p>ğŸ”’ Only group admins can run /groupsetup.</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ“± Manage Group â†’ ]   [ â­ Upgrade Group â†’ ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.11  /autoscan</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/autoscan  </strong>â€” Toggle auto-scan mode on or off</p></td></tr><tr><td><p><strong>Access</strong></p><p>Premium group admins only</p><p><strong>Context</strong></p><p>Group chat only</p></td><td><p><strong>Logic</strong></p><p>1. Verify sender is group admin.</p><p>2. Verify group has premium plan active.</p><p>3. If not premium â†’ show upgrade message.</p><p>4. If premium + admin â†’ toggle autoscan_enabled flag in groups table.</p><p>5. Confirm new state to admin.</p></td></tr><tr><td><p><strong>Turning ON</strong></p></td><td><p>âœ… Auto-scan enabled.</p><p>I'll now silently monitor all images and links in this group.</p><p>I'll only speak up when confidence is above [threshold]%.</p><p>Current threshold: 85% (change in group settings via /groupsetup)</p></td></tr><tr><td><p><strong>Turning OFF</strong></p></td><td><p>â¸ Auto-scan disabled.</p><p>I'll stay quiet until someone tags me directly.</p><p>Turn it back on anytime with /autoscan.</p></td></tr><tr><td><p><strong>Not premium</strong></p></td><td><p>ğŸ”’ Auto-scan is a Group Premium feature.</p><p>Upgrade this group to enable silent monitoring.</p><p>Plan: â‚¹299/month â€” unlimited checks + auto-scan.</p></td></tr><tr><td><p><strong>Not admin</strong></p></td><td><p>ğŸ”’ Only group admins can toggle auto-scan.</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ“± Group Settings â†’ ]</strong></p></td></tr></table></td></tr></table><h2><strong>2.12  /groupstats</strong></h2><table><tr><td><table><tr><td colspan="2"><p><strong>/groupstats  </strong>â€” Show group usage statistics</p></td></tr><tr><td><p><strong>Access</strong></p><p>Group admins only</p><p><strong>Context</strong></p><p>Group chat only</p></td><td><p><strong>Logic</strong></p><p>1. Verify sender is group admin.</p><p>2. Fetch group's check stats from Supabase.</p><p>3. Show: checks today, checks this month, high risk caught, plan status.</p></td></tr><tr><td><p><strong>Stats message</strong></p></td><td><p>ğŸ“Š Group Stats â€” [Group Name]</p><p>Today:        [N] checks  ([N] HIGH, [N] MEDIUM, [N] LOW)</p><p>This month:   [N] checks  ([N] HIGH, [N] MEDIUM, [N] LOW)</p><p>All time:     [N] checks</p><p>ğŸš¨ High risk caught this month: [N]</p><p>   (content flagged above 80% confidence)</p><p>Plan: [FREE / GROUP PREMIUM â€” expires date]</p></td></tr><tr><td><p><strong>Not admin</strong></p></td><td><p>ğŸ”’ Only group admins can view group stats.</p></td></tr><tr><td><p><strong>Buttons</strong></p></td><td><p><strong>[ ğŸ“± Full Dashboard â†’ ]</strong></p></td></tr></table></td></tr></table><h1><strong>3. Non-Command Message Handlers</strong></h1><p>These are triggered by messages that are not commands â€” the most important interactions in the bot.</p><h2><strong>3.1 Image / Photo Received</strong></h2><table><tr><td><p><strong>ğŸ“¸ Image Handler Logic &amp; Responses</strong></p><p>TRIGGER: User sends a photo or image document in private chat OR bot is tagged in a group reply to an image.</p><p>HANDLER STEPS (see Doc 2, Flow C for full detail):</p><p>  1. Check user's credit allowance â†’ if 0: show paywall message</p><p>  2. Acknowledge: 'ğŸ” On it... give me 3 seconds.'</p><p>  3. Download image to memory â†’ generate SHA-256 hash</p><p>  4. Check cache â†’ if HIT: return cached result immediately</p><p>  5. Call Sightengine API â†’ map score to risk level</p><p>  6. Delete image from memory â†’ save hash + score to DB</p><p>  7. Return formatted result (see templates below)</p><p>ACKNOWLEDGEMENT (sent immediately, before API call):</p><p>  'ğŸ” On it... give me 3 seconds.'</p><p>HIGH RISK RESULT (score &gt; 0.80):</p><p>  'ğŸš¨ Smells very fake. [X]% chance this image is AI-generated.'</p><p>  ''</p><p>  'ğŸ“Š Breakdown:'</p><p>  '  â€¢ AI detection score: [X]%'</p><p>  '  â€¢ EXIF metadata: [present / missing âš ï¸]'</p><p>  ''</p><p>  'âš ï¸  Verdict: HIGH RISK â€” do not share as genuine.'</p><p>  'ğŸ“„ Full report â†’ [Open in App]'</p><p>  ''</p><p>  '[Group only] ğŸ” Tag @NahThatsFakeBot anywhere to catch fakes.'</p><p>  ''</p><p>  'âš ï¸ Probabilistic analysis only. Not a legal determination.'</p><p>MEDIUM RISK RESULT (score 0.40â€“0.80):</p><p>  'âš ï¸ Something's off here. [X]% chance this image is AI-generated.'</p><p>  ''</p><p>  'ğŸ“Š Breakdown:'</p><p>  '  â€¢ AI detection score: [X]% â€” inconclusive'</p><p>  '  â€¢ EXIF metadata: [present / missing âš ï¸]'</p><p>  ''</p><p>  'ğŸ¤” Verdict: MEDIUM RISK â€” we're not fully sure. Proceed carefully.'</p><p>  'ğŸ“„ Full report â†’ [Open in App]'</p><p>  ''</p><p>  'âš ï¸ Probabilistic analysis only. Not a legal determination.'</p><p>LOW RISK RESULT (score &lt; 0.40):</p><p>  'âœ… Looks clean to us. [X]% chance this image is real.'</p><p>  ''</p><p>  'ğŸ“Š Breakdown:'</p><p>  '  â€¢ AI detection score: [X]% â€” likely authentic'</p><p>  '  â€¢ EXIF metadata: [present âœ… / missing âš ï¸]'</p><p>  ''</p><p>  'ğŸ‘ Verdict: LOW RISK â€” seems genuine based on our checks.'</p><p>  'ğŸ“„ Full report â†’ [Open in App]'</p><p>  ''</p><p>  'âš ï¸ No tool is 100% accurate. Always use your own judgement.'</p><p>CACHED RESULT:</p><p>  '[Same result as above] (Cached result â€” checked [date])'</p></td></tr></table><h2><strong>3.2 URL / Link Received</strong></h2><table><tr><td><p><strong>ğŸ”— Link Handler Logic &amp; Responses</strong></p><p>TRIGGER: User sends a message containing a URL (with or without other text).</p><p>HANDLER STEPS (see Doc 2, Flow D for full detail):</p><p>  1. Extract URL from message using regex</p><p>  2. Check user's credit allowance â†’ if 0: show paywall</p><p>  3. Expand shortlinks (bit.ly, t.co, etc.) via HEAD request</p><p>  4. Validate URL safety (SSRF check from Doc 7)</p><p>  5. Acknowledge: 'ğŸ” Checking that link...'</p><p>  6. Parallel calls to Google Safe Browsing + VirusTotal</p><p>  7. Combine signals â†’ map to risk level</p><p>  8. Cache result â†’ return formatted response</p><p>HIGH RISK (Google flags OR VirusTotal 3+ vendors):</p><p>  'ğŸš¨ Scam alert. This link looks dangerous.'</p><p>  ''</p><p>  'ğŸ“Š Breakdown:'</p><p>  '  â€¢ Google Safe Browsing: [SOCIAL_ENGINEERING / MALWARE / SAFE]'</p><p>  '  â€¢ VirusTotal: [N] of 90 security vendors flagged this'</p><p>  '  â€¢ Domain: [domain] ([suspicious TLD noted if applicable])'</p><p>  ''</p><p>  'âš ï¸  Verdict: HIGH RISK â€” do not click or share this link.'</p><p>  'ğŸ“„ Full report â†’ [Open in App]'</p><p>MEDIUM RISK (VirusTotal 1-2 vendors):</p><p>  'âš ï¸ Looks sketchy. [N] security system(s) flagged this link.'</p><p>  ''</p><p>  'ğŸ“Š Breakdown:'</p><p>  '  â€¢ Google Safe Browsing: SAFE'</p><p>  '  â€¢ VirusTotal: [N] of 90 vendors flagged'</p><p>  ''</p><p>  'ğŸ¤” Verdict: MEDIUM RISK â€” proceed carefully. Don't enter passwords.'</p><p>LOW RISK (0 flags from both):</p><p>  'âœ… Looks clean. No flags from our databases.'</p><p>  ''</p><p>  'ğŸ“Š Breakdown:'</p><p>  '  â€¢ Google Safe Browsing: SAFE'</p><p>  '  â€¢ VirusTotal: 0 of 90 vendors flagged'</p><p>  ''</p><p>  'ğŸ‘ Verdict: LOW RISK â€” no known threats detected.'</p><p>  'âš ï¸ Databases aren't always up to date. Stay alert.'</p></td></tr></table><h2><strong>3.3 Group Tag Handler (The Viral Moment)</strong></h2><table><tr><td><p><strong>ğŸ“£ Group Tag â€” @NahThatsFakeBot mentioned in group</strong></p><p>TRIGGER: @NahThatsFakeBot is mentioned in a group message.</p><p>HANDLER STEPS:</p><p>  1. Check if the message is a reply to another message.</p><p>  2. If reply: check what the original message contains (image / link / text).</p><p>  3. If original message has image â†’ process as image check.</p><p>  4. If original message has link â†’ process as link check.</p><p>  5. If no media in original â†’ prompt: see 'No media' response below.</p><p>  6. If not a reply: check if the tag message itself contains image or link.</p><p>  7. Check group's daily quota (10 free / unlimited premium).</p><p>  8. Process check â†’ reply IN GROUP THREAD (not via DM).</p><p>  9. Append self-promo line to all group results.</p><p>NO MEDIA FOUND:</p><p>  'ğŸ” I need an image or link to check!'</p><p>  'Reply to the message you want me to scan, then tag me.'</p><p>GROUP QUOTA EXCEEDED (free group):</p><p>  'â³ This group has used its 10 free checks today.'</p><p>  'Admins: upgrade to Group Premium for unlimited checks.'</p><p>  'ğŸ“± Details â†’ /groupsetup'</p><p>SELF-PROMO LINE (appended to all group results):</p><p>  'ğŸ” Tag @NahThatsFakeBot in any group to catch fakes instantly.'</p></td></tr></table><h2><strong>3.4 Unsupported File Types</strong></h2><table><thead><tr><th><p><strong>File Type Received</strong></p></th><th><p><strong>Bot Response</strong></p></th></tr></thead><tbody><tr><td><p>Video (.mp4, .mov etc.)</p></td><td><p>'ğŸ¬ I can't check videos yet â€” that's coming in Phase 2! Try me with an image or a link for now.'</p></td></tr><tr><td><p>Audio (.mp3, .ogg etc.)</p></td><td><p>'ğŸµ Audio detection is on the roadmap! For now, send me an image or link.'</p></td></tr><tr><td><p>PDF (.pdf)</p></td><td><p>'ğŸ“„ I can't read PDFs yet. Try extracting the link or screenshot from it first.'</p></td></tr><tr><td><p>Sticker</p></td><td><p>'ğŸ˜„ Stickers are Telegram's own content â€” safe to ignore!'</p></td></tr><tr><td><p>GIF</p></td><td><p>Process as image if static frame available. Otherwise: 'Send me a still image for best results.'</p></td></tr><tr><td><p>Contact / Location</p></td><td><p>'ğŸ‘‹ That's not something I can check. Send me an image or a link!'</p></td></tr><tr><td><p>Voice message</p></td><td><p>'ğŸ™ï¸ I can't process voice messages yet. Try me with an image or link.'</p></td></tr></tbody></table><h2><strong>3.5 Paywall Message (Credit Limit Reached)</strong></h2><table><tr><td><p><strong>ğŸ’³ Paywall â€” Exact Copy</strong></p><p>â³ You've used your 3 free checks for today.</p><p>Here's what you can do:</p><p>ğŸ¤ Refer a friend  â†’  +1 permanent credit per referral (never expires)</p><p>â­ Go Premium      â†’  Unlimited checks from â‚¹99/month</p><p>â° Wait it out     â†’  Resets at midnight IST</p><p>Permanent credits are used before your daily limit â€”</p><p>so every referral extends how long you can check for free.</p></td></tr></table><table><tr><td><p><strong>Paywall Buttons</strong></p><p>[ ğŸ¤ Get Referral Link ]   [ â­ View Premium ]</p></td></tr></table><h1><strong>4. Callback Query Handlers (Button Presses)</strong></h1><p>When a user presses an inline keyboard button, Telegram sends a callback_query to your bot. Each button has a unique callback_data string. Here are all callback handlers required.</p><table><thead><tr><th><p><strong>Button Label</strong></p></th><th><p><strong>callback_data</strong></p></th><th><p><strong>Handler Action</strong></p></th></tr></thead><tbody><tr><td><p>ğŸ” Try a Free Check</p></td><td><p>action:start_check</p></td><td><p>Set user state to WAITING_FOR_MEDIA. Send check prompt.</p></td></tr><tr><td><p>â“ How It Works</p></td><td><p>action:how_it_works</p></td><td><p>Send a short explainer message about the detection process.</p></td></tr><tr><td><p>â­ View Plans</p></td><td><p>action:view_plans</p></td><td><p>Send /premium response.</p></td></tr><tr><td><p>Cancel</p></td><td><p>action:cancel</p></td><td><p>Set user state to IDLE. Send: 'Cancelled. Send me anything to check anytime.'</p></td></tr><tr><td><p>ğŸ“‹ Copy Link</p></td><td><p>action:copy_ref:[code]</p></td><td><p>Answer callback with the referral URL as text (copyable).</p></td></tr><tr><td><p>ğŸ“¤ Share Link</p></td><td><p>action:share_ref:[code]</p></td><td><p>Open Telegram share sheet with referral link.</p></td></tr><tr><td><p>ğŸ“Š View Full Stats â†’</p></td><td><p>action:open_tma:referrals</p></td><td><p>Open TMA Referrals screen via WebApp button.</p></td></tr><tr><td><p>ğŸ“± View Full History â†’</p></td><td><p>action:open_tma:history</p></td><td><p>Open TMA History screen via WebApp button.</p></td></tr><tr><td><p>ğŸ“± View Plans &amp; Pay â†’</p></td><td><p>action:open_tma:premium</p></td><td><p>Open TMA Premium screen via WebApp button.</p></td></tr><tr><td><p>ğŸ¤ Refer Instead (Free)</p></td><td><p>action:start_check</p></td><td><p>Alias â€” same as start_check.</p></td></tr><tr><td><p>ğŸ“± Open in App</p></td><td><p>action:open_tma:report:[check_id]</p></td><td><p>Open TMA Check Detail screen for specific check.</p></td></tr><tr><td><p>ğŸ“± Manage Group â†’</p></td><td><p>action:open_tma:group</p></td><td><p>Open TMA Group Dashboard screen.</p></td></tr><tr><td><p>â­ Upgrade Group â†’</p></td><td><p>action:open_tma:group_premium</p></td><td><p>Open TMA Group Premium payment screen.</p></td></tr><tr><td><p>ğŸ”„ Renew Premium â†’</p></td><td><p>action:open_tma:renew</p></td><td><p>Open TMA Premium renewal screen.</p></td></tr></tbody></table><table><tr><td><p><strong>ğŸ’¡ WebApp Button Pattern</strong></p><p>For buttons that open the TMA, use Telegram's WebApp button type:</p><p>InlineKeyboardButton(</p><p>    text='ğŸ“± Open in App',</p><p>    web_app=WebAppInfo(url='https://yourapp.com/check?id=[check_id]')</p><p>)</p><p>This opens the TMA inside Telegram without leaving the app.</p><p>The TMA URL must be HTTPS and registered in @BotFather â†’ Bot Settings â†’ Menu Button.</p></td></tr></table><table><tr><td><p><strong>ğŸ“Œ Document Status</strong></p><p>Document 8 of 13 â€” COMPLETE</p><p>Next: Document 9 â€” API Contracts (exact request/response specs for Sightengine,</p><p>Google Safe Browsing, VirusTotal, Razorpay, Telegram Bot API, and Supabase)</p><p>How to use this document:</p><p>  â†’ Each command card is the complete spec for one bot handler function.</p><p>  â†’ Give your AI IDE one command card at a time when building handlers.</p><p>  â†’ The exact copy in each card is production-ready â€” use it as-is.</p><p>  â†’ All callback_data strings must match exactly between the keyboard builder</p><p>    and the callback query handler or buttons will silently fail.</p></td></tr></table>