<p><strong>ğŸ” Nah That's Fake</strong></p><p>TMA â€” Telegram Mini App Specification</p><p>Document 11 of 13</p><p>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</p><p><strong>Document: </strong>Document 11 of 13 â€” TMA Specification</p><p><strong>Version: </strong>v1.0 â€” MVP</p><p><strong>Date: </strong>February 2026</p><p><strong>Status: </strong>Draft â€” Design &amp; Frontend Reference</p><p><strong>Stack: </strong>HTML / CSS / Vanilla JS (or React) + Supabase JS Client</p><p><strong>Bot Handle: </strong>@NahThatsFakeBot</p><table><tr><td><p><strong>ğŸ“± What This Document Covers</strong></p><p>The complete specification for the Telegram Mini App (TMA) â€” the web interface that</p><p>opens inside Telegram when users tap any 'Open in App' button from the bot.</p><p>Covers: TMA setup and Telegram SDK integration, all 8 screens with layout specs,</p><p>navigation and state management, backend API endpoints the TMA calls,</p><p>Razorpay checkout integration from the TMA side, and theming for dark/light mode.</p></td></tr></table><h1><strong>1. What Is a Telegram Mini App?</strong></h1><p>A Telegram Mini App (TMA) is a web app (HTML/CSS/JS) that runs inside Telegram's built-in browser. Users open it by tapping a button in the bot â€” they never leave Telegram. It looks and feels like a native app.</p><table><thead><tr><th><p><strong>Aspect</strong></p></th><th><p><strong>Detail</strong></p></th></tr></thead><tbody><tr><td><p>Technology</p></td><td><p>Standard HTML/CSS/JavaScript. Can use any JS framework (React, Vue, Vanilla).</p></td></tr><tr><td><p>Hosting</p></td><td><p>Your web server (Railway/Render) or a CDN. Must be HTTPS.</p></td></tr><tr><td><p>Authentication</p></td><td><p>Telegram passes initData (signed user data) on launch â€” no login screen needed.</p></td></tr><tr><td><p>Appearance</p></td><td><p>Telegram provides CSS variables for theme colours â€” auto dark/light mode.</p></td></tr><tr><td><p>Payment</p></td><td><p>Razorpay Checkout.js runs inside the TMA WebView â€” works natively.</p></td></tr><tr><td><p>Size limit</p></td><td><p>No hard limit, but keep initial bundle &lt; 200KB for fast load on mobile.</p></td></tr><tr><td><p>Offline</p></td><td><p>TMA requires internet â€” no offline mode needed for MVP.</p></td></tr></tbody></table><h2><strong>1.1 SDK Setup</strong></h2><table><tr><td><p>&lt;!-- In your TMA's index.html &lt;head&gt; --&gt;</p><p>&lt;script src='https://telegram.org/js/telegram-web-app.js'&gt;&lt;/script&gt;</p><p>&lt;!-- This gives you the window.Telegram.WebApp object --&gt;</p><p>// In your JS:</p><p>const tg = window.Telegram.WebApp;</p><p>// Always call ready() first â€” tells Telegram the app has loaded</p><p>tg.ready();</p><p>// Expand to full screen immediately</p><p>tg.expand();</p><p>// Get user data (auto-populated from Telegram session)</p><p>const user = tg.initDataUnsafe.user;</p><p>// user.id, user.first_name, user.username</p><p>// initData (signed string â€” verify on your backend)</p><p>const initData = tg.initData;</p><p>// Theme</p><p>const colorScheme = tg.colorScheme; // 'dark' | 'light'</p><p>const themeParams = tg.themeParams;  // bg_color, text_color, button_color etc.</p></td></tr></table><h2><strong>1.2 Verifying initData on Backend</strong></h2><p>NEVER trust initDataUnsafe on the frontend for security decisions. Always verify the initData signature on your backend before granting access to any user-specific data.</p><table><tr><td><p>import hmac, hashlib, urllib.parse</p><p>def verify_telegram_init_data(init_data: str, bot_token: str) -&gt; dict | None:</p><p>    &quot;&quot;&quot;Returns parsed user data if valid, None if tampered.&quot;&quot;&quot;</p><p>    parsed = dict(urllib.parse.parse_qsl(init_data))</p><p>    received_hash = parsed.pop('hash', None)</p><p>    if not received_hash:</p><p>        return None</p><p>    </p><p>    # Build check string</p><p>    data_check_string = '\n'.join(</p><p>        f'{k}={v}' for k, v in sorted(parsed.items())</p><p>    )</p><p>    # Generate secret key</p><p>    secret_key = hmac.new(b'WebAppData', bot_token.encode(), hashlib.sha256).digest()</p><p>    # Compute expected hash</p><p>    expected_hash = hmac.new(secret_key, data_check_string.encode(), hashlib.sha256).hexdigest()</p><p>    </p><p>    if not hmac.compare_digest(expected_hash, received_hash):</p><p>        return None  # Tampered â€” reject</p><p>    </p><p>    import json</p><p>    return json.loads(parsed.get('user', '{}'))</p><p># In your API endpoint:</p><p># user = verify_telegram_init_data(request.headers['X-Init-Data'], BOT_TOKEN)</p><p># if not user: raise HTTPException(401)</p></td></tr></table><h1><strong>2. Screen Overview</strong></h1><p>The TMA has 8 screens for MVP. Navigation is bottom tab bar (4 tabs) + back button for sub-screens.</p><table><thead><tr><th><p><strong>Screen</strong></p></th><th><p><strong>Tab</strong></p></th><th><p><strong>Route</strong></p></th><th><p><strong>Description</strong></p></th></tr></thead><tbody><tr><td><p>Home / Dashboard</p></td><td><p>ğŸ  Home</p></td><td><p>/</p></td><td><p>Credits, quick check entry, recent results summary</p></td></tr><tr><td><p>Check Detail</p></td><td><p>ğŸ  Home</p></td><td><p>/check/:id</p></td><td><p>Full breakdown of a single check result</p></td></tr><tr><td><p>History</p></td><td><p>ğŸ• History</p></td><td><p>/history</p></td><td><p>Paginated list of all past checks</p></td></tr><tr><td><p>Referrals</p></td><td><p>ğŸ¤ Refer</p></td><td><p>/referrals</p></td><td><p>Referral link, stats, leaderboard</p></td></tr><tr><td><p>Premium</p></td><td><p>â­ Premium</p></td><td><p>/premium</p></td><td><p>Plan comparison, payment flow</p></td></tr><tr><td><p>Payment Success</p></td><td><p>â­ Premium</p></td><td><p>/premium/success</p></td><td><p>Confirmation screen after payment</p></td></tr><tr><td><p>Settings</p></td><td><p>âš™ï¸ Settings</p></td><td><p>/settings</p></td><td><p>Account info, notifications, legal links</p></td></tr><tr><td><p>Group Dashboard</p></td><td><p>â€”</p></td><td><p>/group/:id</p></td><td><p>Admin-only group stats and config</p></td></tr></tbody></table><h2><strong>2.1 Navigation Structure</strong></h2><table><tr><td><p>Bottom Tab Bar (always visible):</p><p>  [ ğŸ  Home ]   [ ğŸ• History ]   [ ğŸ¤ Refer ]   [ â­ Premium ]   [ âš™ï¸ Settings ]</p><p>Back button (top left) for sub-screens:</p><p>  Home â†’ Check Detail â†’ (back to Home)</p><p>  History â†’ Check Detail â†’ (back to History)</p><p>  Premium â†’ Payment Success â†’ (back to Home on success)</p><p>Deep linking from bot buttons:</p><p>  [Open in App] button â†’ TMA opens at specific route</p><p>  e.g. web_app_url = 'https://app.nahthatsfake.com/check/abc-123'</p><p>  e.g. web_app_url = 'https://app.nahthatsfake.com/premium'</p><p>  e.g. web_app_url = 'https://app.nahthatsfake.com/referrals'</p></td></tr></table><h1><strong>3. Screen Specifications</strong></h1><h2><strong>3.1 Home / Dashboard</strong></h2><table><tr><td><p><strong>ğŸ“±  Home / Dashboard  â€”  /</strong></p></td></tr><tr><td><p><strong>Header: </strong>Nah That's Fake logo (left) + user first_name (right)</p><p><strong>Credits bar: </strong>[ Daily: 2/3 remaining ]  [ Permanent: 5 credits ]  â€” tappable â†’ credits detail</p><p><strong>Quick check: </strong>Large tap target: 'ğŸ” Check something' â†’ opens bot in check mode (Telegram.WebApp.openTelegramLink)</p><p><strong>Recent checks: </strong>Last 3 check cards: emoji + risk badge + truncated content + time ago â†’ tap â†’ Check Detail</p><p><strong>CTA (free user): </strong>Banner: 'Refer friends â†’ permanent credits' with [Get Link] button</p><p><strong>CTA (premium): </strong>Banner: 'Premium active â€” N days remaining' with subtle renew reminder</p></td></tr></table><table><tr><td><p><strong>ğŸ¨ Home Screen â€” Key Design Rules</strong></p><p>The Trust Score badge on each check card is the visual anchor.</p><p>  ğŸš¨ HIGH   â†’ Red badge (#DC2626)</p><p>  âš ï¸ MEDIUM â†’ Amber badge (#F59E0B)</p><p>  âœ… LOW    â†’ Green badge (#16A34A)</p><p>Credits bar: use progress-bar style. 2/3 checks = 66% filled bar.</p><p>Empty state (no checks yet): large ğŸ” icon + 'Send me an image or link in the bot to get started.'</p><p>Premium users: replace referral CTA with 'Invite friends to earn their free credits'.</p></td></tr></table><h2><strong>3.2 Check Detail</strong></h2><table><tr><td><p><strong>ğŸ“±  Check Detail  â€”  /check/:id</strong></p></td></tr><tr><td><p><strong>Back button: </strong>â† Back (to Home or History, depending on entry point)</p><p><strong>Trust Score: </strong>HUGE central display: '87%' in risk colour + risk label below ('HIGH RISK')</p><p><strong>Content info: </strong>Type badge (IMAGE / LINK) + timestamp + 'Cached' label if cached</p><p><strong>Breakdown: </strong>Card: AI Detection Score, EXIF Status (image) or Vendor Flags (link)</p><p><strong>API sources: </strong>Small text: 'Checked with Sightengine + VirusTotal' â€” transparency</p><p><strong>Disclaimer: </strong>Grey text at bottom: 'Probabilistic analysis only. Not a legal determination.'</p><p><strong>Export (Premium only): </strong>[ ğŸ“„ Export PDF Report ] button â€” generates and downloads PDF</p><p><strong>Share button: </strong>[ ğŸ“¤ Share ] â€” shares screenshot of result card via Telegram</p></td></tr></table><table><tr><td><p><strong>ğŸ¨ Check Detail â€” Key Design Rules</strong></p><p>The % number must be the largest element on screen â€” minimum 64px font size.</p><p>Colour the entire top section (above the fold) in the risk colour at 10% opacity.</p><p>  HIGH:   rgba(220, 38, 38, 0.10)  â€” subtle red tint</p><p>  MEDIUM: rgba(245, 158, 11, 0.10) â€” subtle amber tint</p><p>  LOW:    rgba(22, 163, 74, 0.10)  â€” subtle green tint</p><p>Breakdown card uses a 2-column layout: label (grey) on left, value on right.</p><p>PDF export is Premium only â€” show lock icon + 'Premium' label for free users.</p><p>Cached results show: '(Cached â€” checked [date])' in small grey text.</p></td></tr></table><h2><strong>3.3 History</strong></h2><table><tr><td><p><strong>ğŸ“±  History  â€”  /history</strong></p></td></tr><tr><td><p><strong>Header: </strong>'Your Check History'</p><p><strong>Filter bar: </strong>[ All ] [ Images ] [ Links ] â€” filter tabs. Active tab underlined.</p><p><strong>List: </strong>Paginated list of check cards. 20 per page. Infinite scroll preferred.</p><p><strong>Each card: </strong>Risk badge + content type icon + truncated hash/URL + time ago + risk %</p><p><strong>Empty state: </strong>ğŸ• icon + 'No checks yet. Send me something in the bot!'</p><p><strong>Free limit: </strong>Free users see last 30 checks only. Blur older entries + 'Premium' lock.</p></td></tr></table><h2><strong>3.4 Referrals</strong></h2><table><tr><td><p><strong>ğŸ“±  Referrals  â€”  /referrals</strong></p></td></tr><tr><td><p><strong>Header: </strong>'Refer &amp; Earn'</p><p><strong>Credit explain: </strong>You get: +1 permanent credit  |  They get: +2 bonus credits</p><p><strong>Referral link: </strong>Full URL displayed + [ ğŸ“‹ Copy ] + [ ğŸ“¤ Share ] buttons</p><p><strong>Stats row: </strong>[ Total referred: N ] [ Credited: N ] [ Pending: N ]</p><p><strong>Leaderboard: </strong>Top 10 referrers (anonymous) â€” shows rank + credit count</p><p><strong>How it works: </strong>Collapsible: 3-step visual explanation of the referral flow</p></td></tr></table><h2><strong>3.5 Premium</strong></h2><table><tr><td><p><strong>ğŸ“±  Premium  â€”  /premium</strong></p></td></tr><tr><td><p><strong>Header: </strong>'Go Premium'  (or 'Your Plan' if already premium)</p><p><strong>Plan cards: </strong>3 cards: FREE / INDIVIDUAL / GROUP. Currently active plan highlighted.</p><p><strong>FREE card: </strong>3 checks/day, referral credits. No button (current plan for free users).</p><p><strong>IND MONTHLY: </strong>â‚¹99/month Â· 250 Stars. Unlimited checks, full reports, PDF export.</p><p><strong>IND ANNUAL: </strong>â‚¹799/year Â· 1999 Stars (save 33%). Same features + priority support.</p><p><strong>GROUP: </strong>â‚¹299/month Â· 750 Stars. All Individual + auto-scan + group dashboard.</p><p><strong>Payment method: </strong>Toggle: [ Pay with UPI/Card ] [ Pay with â­ Stars ]</p><p><strong>Pay button: </strong>[ Pay â‚¹99 ] or [ Pay 250 Stars ] â€” triggers payment flow</p><p><strong>Legal note: </strong>Stars payments are non-refundable. Card/UPI: 48h refund policy.</p></td></tr></table><table><tr><td><p><strong>ğŸ’³ Payment Flow from TMA (Razorpay)</strong></p><p>1. User taps [ Pay â‚¹99 ]</p><p>2. TMA calls POST /api/create-order â†’ gets {order_id, amount, currency}</p><p>3. TMA initialises Razorpay Checkout:</p><p>   const rzp = new Razorpay({</p><p>     key: RAZORPAY_KEY_ID,</p><p>     order_id: order_id,</p><p>     amount: amount,</p><p>     currency: 'INR',</p><p>     name: 'Nah That\'s Fake',</p><p>     description: 'Individual Premium â€” Monthly',</p><p>     handler: function(response) { verifyPayment(response); }</p><p>   });</p><p>   rzp.open();</p><p>4. User completes payment in Razorpay overlay</p><p>5. handler() fires with {razorpay_payment_id, razorpay_order_id, razorpay_signature}</p><p>6. TMA calls POST /api/verify-payment with these 3 fields</p><p>7. Backend verifies signature â†’ activates premium â†’ returns {success: true}</p><p>8. TMA navigates to /premium/success</p><p>Script tag: &lt;script src='https://checkout.razorpay.com/v1/checkout.js'&gt;&lt;/script&gt;</p></td></tr></table><h2><strong>3.6 Payment Success</strong></h2><table><tr><td><p><strong>ğŸ“±  Payment Success  â€”  /premium/success</strong></p></td></tr><tr><td><p><strong>Animation: </strong>Confetti or checkmark animation (CSS, no external library needed)</p><p><strong>Heading: </strong>ğŸ‰ You're Premium!</p><p><strong>Sub-heading: </strong>Unlimited checks activated. Valid until [date].</p><p><strong>CTA: </strong>[ ğŸ” Start Checking ] â†’ navigates to Home</p><p><strong>Share prompt: </strong>'Tell your friends about Nah That\'s Fake' + referral link below</p></td></tr></table><h2><strong>3.7 Settings</strong></h2><table><tr><td><p><strong>ğŸ“±  Settings  â€”  /settings</strong></p></td></tr><tr><td><p><strong>Account section: </strong>Telegram avatar + name + user ID. [ Delete My Account ] danger button.</p><p><strong>Plan section: </strong>Current plan badge + expiry date + [ Manage Plan ] button.</p><p><strong>Notifications: </strong>Toggle: Expiry reminders (on by default). Toggle: Referral notifications.</p><p><strong>Legal section: </strong>Links: Terms of Service Â· Privacy Policy Â· Disclaimer Â· Refund Policy</p><p><strong>Support: </strong>[ Contact Support ] â†’ opens Telegram DM to support handle</p><p><strong>Version: </strong>App version + 'Made with â¤ï¸ in India'</p></td></tr></table><h2><strong>3.8 Group Dashboard</strong></h2><table><tr><td><p><strong>ğŸ“±  Group Dashboard  â€”  /group/:id  (Admin only)</strong></p></td></tr><tr><td><p><strong>Header: </strong>Group name + member count</p><p><strong>Plan status: </strong>FREE or âœ… GROUP PREMIUM (active until date)</p><p><strong>Auto-scan toggle: </strong>Toggle: ON/OFF + threshold slider (70%â€“95%)</p><p><strong>Stats today: </strong>Checks: N  |  HIGH: N  |  MEDIUM: N  |  LOW: N</p><p><strong>Stats month: </strong>Same breakdown for current month</p><p><strong>Top catches: </strong>Last 5 HIGH RISK results caught in this group</p><p><strong>Upgrade CTA: </strong>[ â­ Upgrade Group â†’ â‚¹299/month ] â€” only shown for free groups</p></td></tr></table><h1><strong>4. Backend API Endpoints</strong></h1><p>These are the HTTP endpoints your FastAPI/Express backend must expose for the TMA to call. All endpoints require a valid X-Init-Data header (Telegram initData string) for authentication.</p><table><tr><td><p><strong>ğŸ” Authentication Header (all endpoints)</strong></p><p>Every TMA API call must include:</p><p>  X-Init-Data: [tg.initData]  â€” the raw initData string from Telegram SDK</p><p>Backend verifies this with verify_telegram_init_data() from Document 9.</p><p>If verification fails â†’ 401 Unauthorized. TMA shows 'Session expired, please reopen.'</p></td></tr></table><h2><strong>4.1 User Endpoints</strong></h2><table><tr><td><p><strong> GET </strong>  /api/user/me   â€”   Get current user's full profile, plan, and credits</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header</p><p><strong>Response: </strong></p><p>  { telegram_user_id, username, first_name,</p><p>    plan, premium_until, grace_until,</p><p>    permanent_credits, referral_code,</p><p>    checks_today, daily_limit: 3 }</p></td></tr></table><h2><strong>4.2 Check Endpoints</strong></h2><table><tr><td><p><strong> GET </strong>  /api/checks   â€”   Get paginated check history</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header</p><p><strong>Request: </strong></p><p>  ?page=1&amp;limit=20&amp;type=image|link|all</p><p><strong>Response: </strong></p><p>  { checks: [{ id, check_type, risk_level, score, cached, created_at }],</p><p>    total, page, has_more }</p></td></tr></table><table><tr><td><p><strong> GET </strong>  /api/checks/:id   â€”   Get full detail for one check</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header</p><p><strong>Response: </strong></p><p>  { id, check_type, risk_level, score, content_hash,</p><p>    exif_present, api_source, raw_response, cached, created_at }</p></td></tr></table><table><tr><td><p><strong> GET </strong>  /api/checks/:id/pdf   â€”   Generate and return PDF report for one check</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header (Premium only)</p><p><strong>Response: </strong></p><p>  Content-Type: application/pdf  (binary stream)</p></td></tr></table><h2><strong>4.3 Payment Endpoints</strong></h2><table><tr><td><p><strong> POST </strong>  /api/payments/create-order   â€”   Create Razorpay order for selected plan</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header</p><p><strong>Request: </strong></p><p>  { plan_id: 'ind_monthly' | 'ind_annual' | 'grp_monthly',</p><p>    group_id?: string  // required for grp_monthly }</p><p><strong>Response: </strong></p><p>  { order_id: 'order_AbcDef123',</p><p>    amount: 9900,</p><p>    currency: 'INR',</p><p>    key_id: RAZORPAY_KEY_ID }</p></td></tr></table><table><tr><td><p><strong> POST </strong>  /api/payments/verify   â€”   Verify Razorpay payment signature and activate premium</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header</p><p><strong>Request: </strong></p><p>  { razorpay_payment_id: string,</p><p>    razorpay_order_id: string,</p><p>    razorpay_signature: string }</p><p><strong>Response: </strong></p><p>  { success: true, plan: 'ind_monthly',</p><p>    premium_until: '2026-03-22T00:00:00Z' }</p><p>  // or { success: false, error: 'invalid_signature' }</p></td></tr></table><h2><strong>4.4 Referral Endpoints</strong></h2><table><tr><td><p><strong> GET </strong>  /api/referrals   â€”   Get user's referral stats and link</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header</p><p><strong>Response: </strong></p><p>  { referral_code: 'ABC12345',</p><p>    referral_url: 't.me/NahThatsFakeBot?start=ref_ABC12345',</p><p>    total_referrals: 5, credited: 4, pending: 1 }</p></td></tr></table><table><tr><td><p><strong> GET </strong>  /api/referrals/leaderboard   â€”   Get top 10 referrers (anonymised)</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header</p><p><strong>Response: </strong></p><p>  { leaderboard: [</p><p>    { rank: 1, display_name: 'User #1', credits_earned: 12 },</p><p>    ...10 entries total</p><p>  ] }</p></td></tr></table><h2><strong>4.5 Group Endpoints</strong></h2><table><tr><td><p><strong> GET </strong>  /api/groups/:group_id   â€”   Get group config and stats</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header (admin only)</p><p><strong>Response: </strong></p><p>  { telegram_group_id, group_name, plan,</p><p>    premium_until, autoscan_enabled, autoscan_threshold,</p><p>    checks_today, total_checks }</p></td></tr></table><table><tr><td><p><strong> PATCH </strong>  /api/groups/:group_id   â€”   Update group config (auto-scan toggle/threshold)</p></td></tr><tr><td><p><strong>Auth: </strong>X-Init-Data header (admin only)</p><p><strong>Request: </strong></p><p>  { autoscan_enabled?: boolean,</p><p>    autoscan_threshold?: number }</p><p><strong>Response: </strong></p><p>  { success: true, updated: { autoscan_enabled, autoscan_threshold } }</p></td></tr></table><h1><strong>5. Theming â€” Dark &amp; Light Mode</strong></h1><p>Telegram provides CSS variables that automatically adapt to the user's theme. Use these instead of hardcoded colours wherever possible.</p><table><tr><td><p>/* Use Telegram's CSS variables for automatic dark/light mode */</p><p>:root {</p><p>  --tg-bg:          var(--tg-theme-bg-color);          /* Page background */</p><p>  --tg-text:        var(--tg-theme-text-color);         /* Primary text */</p><p>  --tg-hint:        var(--tg-theme-hint-color);         /* Secondary/hint text */</p><p>  --tg-link:        var(--tg-theme-link-color);         /* Links */</p><p>  --tg-button:      var(--tg-theme-button-color);       /* Primary button bg */</p><p>  --tg-button-text: var(--tg-theme-button-text-color);  /* Primary button text */</p><p>  --tg-secondary-bg:var(--tg-theme-secondary-bg-color); /* Card backgrounds */</p><p>}</p><p>/* Brand colours â€” same in dark and light */</p><p>:root {</p><p>  --brand-blue:   #1A56DB;</p><p>  --risk-high:    #DC2626;</p><p>  --risk-medium:  #F59E0B;</p><p>  --risk-low:     #16A34A;</p><p>  --risk-unknown: #64748B;</p><p>}</p><p>/* Example usage: */</p><p>body   { background: var(--tg-bg); color: var(--tg-text); }</p><p>.card  { background: var(--tg-secondary-bg); border-radius: 12px; }</p><p>.hint  { color: var(--tg-hint); font-size: 13px; }</p><p>button { background: var(--tg-button); color: var(--tg-button-text); }</p></td></tr></table><h2><strong>5.1 Component Colour System</strong></h2><table><thead><tr><th><p><strong>Component</strong></p></th><th><p><strong>Dark Mode</strong></p></th><th><p><strong>Light Mode</strong></p></th><th><p><strong>Use Telegram var?</strong></p></th></tr></thead><tbody><tr><td><p>Page background</p></td><td><p>#0F172A</p></td><td><p>#FFFFFF</p></td><td><p>Yes â€” var(--tg-bg)</p></td></tr><tr><td><p>Card background</p></td><td><p>#1E293B</p></td><td><p>#F8FAFC</p></td><td><p>Yes â€” var(--tg-secondary-bg)</p></td></tr><tr><td><p>Primary text</p></td><td><p>#FFFFFF</p></td><td><p>#1E293B</p></td><td><p>Yes â€” var(--tg-text)</p></td></tr><tr><td><p>Secondary text</p></td><td><p>#94A3B8</p></td><td><p>#64748B</p></td><td><p>Yes â€” var(--tg-hint)</p></td></tr><tr><td><p>HIGH risk badge</p></td><td><p>#DC2626</p></td><td><p>#DC2626</p></td><td><p>No â€” brand constant</p></td></tr><tr><td><p>MEDIUM risk badge</p></td><td><p>#F59E0B</p></td><td><p>#F59E0B</p></td><td><p>No â€” brand constant</p></td></tr><tr><td><p>LOW risk badge</p></td><td><p>#16A34A</p></td><td><p>#16A34A</p></td><td><p>No â€” brand constant</p></td></tr><tr><td><p>Primary button</p></td><td><p>#1A56DB</p></td><td><p>#1A56DB</p></td><td><p>Yes â€” var(--tg-button)</p></td></tr><tr><td><p>Divider lines</p></td><td><p>#334155</p></td><td><p>#E2E8F0</p></td><td><p>No â€” use opacity trick</p></td></tr><tr><td><p>Trust Score %</p></td><td><p>Risk colour</p></td><td><p>Risk colour</p></td><td><p>No â€” brand constant</p></td></tr></tbody></table><h1><strong>6. Technical Setup</strong></h1><h2><strong>6.1 Recommended File Structure</strong></h2><table><tr><td><p>tma/</p><p>â”œâ”€â”€ index.html          # Entry point</p><p>â”œâ”€â”€ app.js              # Main app logic + router</p><p>â”œâ”€â”€ api.js              # All fetch calls to backend</p><p>â”œâ”€â”€ auth.js             # initData handling + user session</p><p>â”œâ”€â”€ theme.js            # Telegram theme variable setup</p><p>â”œâ”€â”€ screens/</p><p>â”‚   â”œâ”€â”€ home.js         # Home screen</p><p>â”‚   â”œâ”€â”€ check-detail.js # Check detail screen</p><p>â”‚   â”œâ”€â”€ history.js      # History screen</p><p>â”‚   â”œâ”€â”€ referrals.js    # Referrals screen</p><p>â”‚   â”œâ”€â”€ premium.js      # Premium + payment screen</p><p>â”‚   â””â”€â”€ settings.js     # Settings screen</p><p>â”œâ”€â”€ components/</p><p>â”‚   â”œâ”€â”€ bottom-nav.js   # Tab bar</p><p>â”‚   â”œâ”€â”€ check-card.js   # Reusable check card</p><p>â”‚   â””â”€â”€ risk-badge.js   # Colour-coded risk badge</p><p>â””â”€â”€ styles/</p><p>    â”œâ”€â”€ base.css        # Reset + Telegram vars</p><p>    â”œâ”€â”€ components.css  # Shared components</p><p>    â””â”€â”€ screens.css     # Screen-specific styles</p></td></tr></table><h2><strong>6.2 Razorpay Script Loading</strong></h2><table><tr><td><p>&lt;!-- Load Razorpay checkout script in index.html --&gt;</p><p>&lt;!-- Load conditionally â€” only on Premium screen to save bandwidth --&gt;</p><p>// In premium.js:</p><p>function loadRazorpayScript() {</p><p>  return new Promise((resolve, reject) =&gt; {</p><p>    if (window.Razorpay) { resolve(); return; }</p><p>    const script = document.createElement('script');</p><p>    script.src = 'https://checkout.razorpay.com/v1/checkout.js';</p><p>    script.onload = resolve;</p><p>    script.onerror = reject;</p><p>    document.head.appendChild(script);</p><p>  });</p><p>}</p><p>async function initiatePayment(planId) {</p><p>  await loadRazorpayScript();</p><p>  const { order_id, amount, key_id } = await api.createOrder(planId);</p><p>  const rzp = new Razorpay({</p><p>    key: key_id,</p><p>    order_id,</p><p>    amount,</p><p>    currency: 'INR',</p><p>    name: 'Nah That\'s Fake',</p><p>    description: planNames[planId],</p><p>    prefill: { name: tg.initDataUnsafe.user.first_name },</p><p>    theme: { color: '#1A56DB' },</p><p>    handler: async (response) =&gt; {</p><p>      const result = await api.verifyPayment(response);</p><p>      if (result.success) router.navigate('/premium/success');</p><p>      else showError('Payment could not be verified. Contact support.');</p><p>    }</p><p>  });</p><p>  rzp.open();</p><p>}</p></td></tr></table><h2><strong>6.3 Registering the TMA in BotFather</strong></h2><table><tr><td><p><strong>âš™ï¸ Steps to Register Your TMA</strong></p><p>1. Open @BotFather in Telegram</p><p>2. Send /mybots â†’ select @NahThatsFakeBot</p><p>3. Select 'Bot Settings' â†’ 'Menu Button'</p><p>4. Set menu button URL to: https://app.nahthatsfake.com</p><p>   (or your Railway/Render app URL)</p><p>5. This creates the ğŸ” button in the bottom-left of private chats with the bot.</p><p>For bot buttons that open specific screens (deep links):</p><p>  Use InlineKeyboardButton with web_app=WebAppInfo(url='https://app.nahthatsfake.com/premium')</p><p>  Telegram will open the TMA at that exact URL with initData passed automatically.</p><p>Domain whitelist: BotFather â†’ Bot Settings â†’ Domain â€” add your TMA domain.</p><p>This is required for initData to be signed correctly.</p></td></tr></table><table><tr><td><p><strong>ğŸ“Œ Document Status</strong></p><p>Document 11 of 13 â€” COMPLETE</p><p>Next: Document 12 â€” Testing &amp; QA Checklist</p><p>(complete test cases for every user flow, bot handler, payment flow,</p><p>edge cases, and the pre-launch sign-off checklist)</p><p>How to use this document:</p><p>  â†’ Sections 3.1â€“3.8 are the design brief for each screen â€” share with Figma/designer.</p><p>  â†’ Section 4 lists every endpoint â€” implement these in FastAPI before building the TMA.</p><p>  â†’ Section 5 has the CSS theming system â€” copy directly into base.css.</p><p>  â†’ Section 6.2 has the complete Razorpay integration â€” paste into premium.js.</p><p>  â†’ The TMA must be served from HTTPS â€” Railway/Render provides this automatically.</p></td></tr></table>